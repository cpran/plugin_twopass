# This file is generated by GitLab CI
'':
  script:
  - # Clear workspace, just in case
  - rm -rf ~/.praat-dir/plugin{utils,selection,testsimple}
  - rm -rf ../plugin_{utils,selection,testsimple}
  - # Clone all dependencies
  - git clone https://gitlab.com/cpran/plugin_selection.git ../plugin_selection
  - git clone https://gitlab.com/cpran/plugin_testsimple.git ../plugin_testsimple
  - git clone https://gitlab.com/cpran/plugin_utils.git ../plugin_utils
  - # Dependencies must exist in parent folder and preferences directory
  - cp -fa . ~/.praat-dir/plugin_twopass
  - cp -fa ../plugin_testsimple ~/.praat-dir/plugin_testsimple
  - cp -fa ../plugin_utils ~/.praat-dir/plugin_utils
  - cp -fa ../plugin_selection ~/.praat-dir/plugin_selection
  - # Run tests
  - prove -v --exec "praat"
  - # Clear workspace
  - rm -rf ~/.praat-dir/plugin_selection ../plugin_selection
  - rm -rf ~/.praat-dir/plugin_utils ../plugin_utils
  - rm -rf ~/.praat-dir/plugin_testsimple ../plugin_testsimple
  - rm -rf ~/.praat-dir/plugin_twopass
  tags:
    - cpran
  except:
  - tags